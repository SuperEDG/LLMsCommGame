# 提示词框架构成（以女巫为例）

## 1. 问题库

**公共问题**
- 当前是白天还是夜晚阶段？根据游戏规则，我在这个阶段应该做什么？
- 我的玩家名字是什么，我的角色是什么？我在这个游戏中的最终目标是什么？
- 基于当前情况，如果我现在在谈话中透露我的角色，可能的后果是什么？
- 我的角色被揭露了吗（不考虑主持人和我自己）？我现在要揭露我的角色吗？
- 根据上面的对话，哪些玩家明确暗示了他们的角色？
- 根据聊天记录，你能猜到一些玩家的角色吗？

**女巫问题**
- 根据对话和我的推理，谁最有可能是一个还活着的狼人？我应该毒杀他吗？
- 我现在应该使用我的解药或毒药吗？如果我现在用了，以后就不能用了。
- 我现在应该透露我的角色吗？

## 2. 问题回答模板

- **游戏规则和角色描述**：包括基本的游戏规则、角色能力与目标和一些基础策略。
- **最近的K条信息**：指的是代理在当前天最近接收的K条信息。
  - O: 代表最近的信息，如怀疑、猜测和自述。
  - V: 代表通过启发式选择的关键信息（角色披露，能力使用，投票意图）。
  - R: 代表基于O和V的反映或总结。
- **从过去的经验中提取的建议**：使用以往的经验来在当前轮次中指导决策。
- **思维链提示(CoT prompt)**：引导模型按照一定的逻辑推理过程生成响应。

## 3. 女巫视角示例演示

1. 游戏规则和描述

你正在和一些其他玩家玩一个叫做“狼人杀”的游戏。这个游戏是基于文本对话的。这里有一些游戏规则：

- **角色**：主持人也是主持，他组织了这个游戏，你需要正确回答他的指示。不要和主持人交谈。游戏中有五个角色，狼人、村民、先知、守卫和女巫。这个游戏有两个交替阶段，白天和黑夜。当是黑夜时：你和主持人的谈话内容是保密的。你不需要担心其他玩家和主持人知道你说了什么和做了什么。在夜晚不需要担心其他人的怀疑。如果你是狼人，你可以知道你的队友想杀谁，并且你应该基于你的分析投票选择杀害一个玩家。在所有狼人投票后，得票最多的玩家将被杀害。如果没有共识，就不会有人被杀：如果你是女巫，你有一瓶可以在黑夜后救活一个被狼人目标的解药，和一瓶可以在黑夜后毒死一个玩家的毒药。毒药和解药都只能使用一次。如果你是先知，你可以在每个夜晚验证一个玩家是否是狼人，这是非常重要的。如果你是守卫，你可以在每个夜晚保护一个玩家，防止玩家被狼人杀害，但守卫不能抵抗女巫的毒药，守卫也不能在连续的两个夜晚保护同一个玩家。村民在夜晚不能做任何事情。在白天：你和所有玩家（包括你的敌人）讨论。讨论结束后，玩家投票选择淘汰他们怀疑是狼人的一个玩家。得票最多的玩家将被淘汰。主持人会说出谁被杀了，否则没有人被杀。注意，村民、先知、守卫和女巫都在村民一方，他们有相同的目标。
- **目标**：如果你是狼人，你的目标是和其他狼人合作，在最后杀死所有不是狼人的玩家。如果你不是狼人，你需要和你的伙伴一旦发现某些玩家有可能是狼人就杀死他们。这可以大大提高你赢的机会，尽管这有些风险。如果一个玩家被杀，他就不能再做任何事情，将被淘汰出游戏。
- **提示**：为了完成目标：在夜晚，你应该分析并正确使用你的能力。在白天，你需要仔细推理其他玩家的角色，并且小心不要轻易透露你自己的角色，除非你是在欺骗其他玩家。做决定/投票时只给出玩家的名字，不要生成其他玩家的对话。推理要基于你观察到的事实，你不能感知到文本之外的信息（比如声音信息）。你是玩家i（[角色]）。你和其他6个玩家一起玩。不要假装你是其他玩家或主持人。始终用'<EOS>'结束你的回答。

## 2. 最近的K条信息

- 提示LLMs选择问题：
现在是第{t}个[白天或黑夜]。鉴于上述游戏规则和对话，假设你是{代理编号 i}，[角色]，要完成主持人的指示，你首先需要清晰地思考几个问题，以便你在下一步可以做出准确的决定。从下面的问题列表中只选择你认为在当前情况下最重要的五个：{针对特定角色准备的问题} 请重复你选择的五个重要问题，并用'#'分隔它们。
- 提示LLMs提问：
现在是第{t}个[白天或黑夜]。鉴于上述游戏规则和对话，假设你是{代理编号 i}，[角色]，要完成主持人的指示，你首先需要清晰地思考几个问题，以便你在下一步可以做出准确的决定。{选定的问题} 不要回答这些问题。除了上述问题外，请大胆猜测，你还想了解当前情况的什么？请用第一人称提出两个重要的问题，并用'#'分隔它们。
- 提示LLMs生成答案 Ai^t：
现在是第{t}个[白天或黑夜]。鉴于上述游戏规则和对话，假设你是{代理编号 i}，[角色]，对于问题：{问题 qi,j^t} 有{T}个可能的答案：{候选答案 Ui,j^t} 基于上下文生成正确的答案。如果没有直接的答案，你应该基于上下文思考并生成答案。无需给出选项。答案应以第一人称的形式，不超过2个句子，并且没有任何分析和项目编号。
- 提示LLMs进行反思 Ri^t：
现在是第{t}个[白天或黑夜]。假设你是{代理编号 i}，[角色]，你可以根据上述对话和{Ai^t}总结出哪些洞见，以帮助你继续对话并实现你的目标？例如：作为[角色]，1 我观察到... 我认为... 但我是... 所以...
- 提示LLMs提取建议 Si^t：
我检索了一些与我当前面临的情况相似的历史经验。有一个不好的经验：{G0} 也有一组可能包含好的经验的经验：{G1, ..., Gn} 请帮我分析这些经验之间的差异，并从经验集中识别出好的经验。差异主要在于投票杀人还是放过、选择保护某人还是放过、使用药物与否。经验集做了什么而坏经验没有做？以第二人称指出在这样的反思下玩家的最佳做法。清晰地指出是否投票、保护或使用药物，不需要任何先决条件。例如1：经验集包括选择保护某人，而坏经验包括不保护任何人，选择放过。在这样的反思下，你最好的做法是根据你的分析选择保护某人。例如2：坏经验选择放过投票，经验集中的所有经验也选择放过。在这样的反思下，你最好的做法是观察和分析其他玩家的身份。不超过1个句子。如果它们之间没有明显的差异，只生成“没有有用的经验可以使用。”
- 提示LLMs生成最终回应：
现在是第{t}个[白天或黑夜]。根据游戏规则和上下文思考要说什么，尤其是刚才的反思{Ri^t}。此外，也许你可以参考一些历史经验：{Si^t} 给出你的逐步思考过程和你最后推导出的简洁的谈话内容（不超过2个句子）。例如：我的逐步思考过程.... 我简洁的谈话内容...


要求代理由主持人生成响应:
你这个女巫，玩家2，请睁开你的眼睛！现在告诉我今晚你保护谁？请在下面的存活选项中选择一个：[玩家1, 玩家2, 玩家3, 玩家4, 玩家5, 玩家6, 玩家7, pass]。 
问题和答案:
1. 我的玩家名字是什么，我扮演的角色是什么？我在这个游戏中的最终目标是什么？
我是玩家2，女巫。我的最终目标是通过明智地使用我的解药和毒药来保护村民，并与其他玩家一起帮助识别和消除狼人。

2. 基于聊天历史，你能猜到一些玩家的角色吗？
作为女巫，我观察到玩家1可能是个狼人，因为他们似乎试图引导对话，避免讨论角色和怀疑。玩家7似乎是一个专注于保护村民和收集信息的守卫。其他玩家还没有明确暗示他们的角色。

3. 当前是白天还是夜晚阶段？根据游戏规则，我在这个阶段应该做什么？
作为玩家2，女巫，现在是夜晚时间。我应该用我的毒药来消除一个可疑的狼人，但我需要小心，以免意外杀死一个村民。

4. 基于对话和我的推断，谁最有可能是活着的狼人？我应该毒死他吗？
作为女巫，我没有足够的信息来确定谁最有可能是狼人，所以我会在有更多信息之前暂时不用我的毒药。我会试图引导对话，讨论其他玩家的角色和他们的怀疑以获得更多的见解。

5. 我现在应该使用解药还是毒药？如果我现在用它，以后就不能用了。
作为玩家2，女巫，我会等到有更多关于谁最有可能是狼人的信息后再使用我的解药或毒药。

6. 我想知道除了玩家1之外，谁是最可疑的玩家，为什么？
作为女巫，除了玩家1，我怀疑玩家3、玩家5和玩家6，因为他们还没有透露他们的角色或做出任何可疑的举动。我会继续收集信息并观察他们的行为，在天亮结束时做出投票淘汰的决定。

7. 我还想知道，与前几天相比，有没有任何玩家的行为发生了可疑的变化，如果有，是谁，为什么？
我注意到昨晚没有人死，这是个好兆头。我想听听其他玩家关于他们的观察和怀疑。

由代理制作的反思:
作为女巫，我观察到玩家1可能是狼人，因为他们似乎试图引导对话，避免讨论角色和怀疑。玩家7似乎是一个专注于保护村民和收集信息的守卫。其他玩家还没有明确暗示他们的角色。我仍然怀疑玩家3、玩家5和玩家6，因为他们还没有透露他们的角色或做出任何可疑的举动。我会继续收集信息并观察他们的行为，在做出任何结论之前。我们继续分享我们的观察和怀疑来帮助识别狼人和保护村民是很重要的。

从历史经验中提取建议:
在这样的反思下，你最好的做法是根据你的观察和反思明智地使用你的药物。

思考过程:
我的逐步思考过程：
- 基于之前的讨论和投票行为，关于玩家1是狼人的怀疑仍然存在，这与其他玩家的观察一致。
- 然而，还没有足够的证据来确切指控狼人的身份。
- 我会投票杀死玩家1，以消除他们是狼人的可能性，并在下一轮中获取更多信息。

我的简洁谈话内容：
- 我投票杀死玩家1。

最终响应:
我投票杀死玩家1。